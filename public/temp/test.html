<!DOCTYPE><html><head><title>another tip</title></head><body><p>In the beginning, the listing imports the user&rsquo;s fake database, which is just a JSON structure you&nbsp;parse and load into memory.<br />app.get('/users', function(req, res){<br />res.render('users/index', {title: 'Users', users: users});<br />});<br />The listener for the GET /users route simply passes the users &ldquo;database&rdquo; into the views/users/index.jade template. Now you need to change that template to render the users, as shown in<br />Listing 21-7.<br />LISTING 21-7: User list template.<br />h1 Users<br />p<br />a(href="/users/new") Create new profile<br />ul<br />- for(var username in users) {<br />liThis listing iterates over the users object, rendering for each user a list item that contains a link to<br />the detail URL. Here you can see an example of a Jade template and how you can intersperse code<br />with markup.<br />You can now restart the server to test this new code.<br />When you point your browser to http://localhost:3000/users you should see the user list rendered.<br />If you click on one of those user links, you activate the following route listener:<br />app.get('/users/:name', function(req, res, next){<br />var user = users[req.params.name];<br />if (user) {<br />res.render('users/profile', {title: 'User profile', user: user});<br />} else {<br />next();<br />}<br />});<br />This route listener uses the request param containing the username and uses it to look up the user<br />object. If a user is found, it is applied to the users/profile.jade template. If not, the control is<br />passed back to the middleware engine, which in this case will render a "Not found" message.<br />If you click on one of the users in the list, you will get an error screen stating that Express failed to<br />locate the users/profile</p>
<p>This listing iterates over the users object, rendering for each user a list item that contains a link to<br />the detail URL. Here you can see an example of a Jade template and how you can intersperse code<br />with markup.<br />You can now restart the server to test this new code.<br />When you point your browser to http://localhost:3000/users you should see the user list rendered.<br />If you click on one of those user links, you activate the following route listener:<br />app.get('/users/:name', function(req, res, next){<br />var user = users[req.params.name];<br />if (user) {<br />res.render('users/profile', {title: 'User profile', user: user});<br />} else {<br />next();<br />}<br />});<br />This route listener uses the request param containing the username and uses it to look up the user<br />object. If a user is found, it is applied to the users/profile.jade template. If not, the control is<br />passed back to the middleware engine, which in this case will render a "Not found" message.<br />If you click on one of the users in the list, you will get an error screen stating that Express failed to<br />locate the users/profile</p>
<p>This listing iterates over the users object, rendering for each user a list item that contains a link to<br />the detail URL. Here you can see an example of a Jade template and how you can intersperse code<br />with markup.<br />You can now restart the server to test this new code.<br />When you point your browser to http://localhost:3000/users you should see the user list rendered.<br />If you click on one of those user links, you activate the following route listener:<br />app.get('/users/:name', function(req, res, next){<br />var user = users[req.params.name];<br />if (user) {<br />res.render('users/profile', {title: 'User profile', user: user});<br />} else {<br />next();<br />}<br />});<br />This route listener uses the request param containing the username and uses it to look up the user<br />object. If a user is found, it is applied to the users/profile.jade template. If not, the control is<br />passed back to the middleware engine, which in this case will render a "Not found" message.<br />If you click on one of the users in the list, you will get an error screen stating that Express failed to<br />locate the users/profile</p></body></html>